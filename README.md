[docimg]:https://godoc.org/github.com/ardnew/resvn?status.svg
[docurl]:https://godoc.org/github.com/ardnew/resvn
[repimg]:https://goreportcard.com/badge/github.com/ardnew/resvn
[repurl]:https://goreportcard.com/report/github.com/ardnew/resvn

# resvn
#### Run SVN commands on multiple repositories

[![GoDoc][docimg]][docurl] [![Go Report Card][repimg]][repurl]

```
github.com/ardnew/resvn 0.6.2 linux-amd64 main@3e8e9ec 2022-06-10T17:48:13Z

USAGE
  resvn [flags] [repo-pattern ...] [-- svn-command-line ...]

FLAGS (mnemonics shown in [brackets])
  -c             use [case]-sensitive matching
  -d             print commands which would be executed ([dry-run])
  -f path        use repository definitions from [file] path
  -l user:pass   use user:pass to authenticate with SVN or REST API ([login])
  -o             use logical-[or] matching if multiple patterns given
  -q             suppress all non-essential and error messages ([quiet])
  -s url         use [server] url to construct all URLs (default $RESVN_URL)
  -u             [update] cached repository definitions from server
  -w             construct [web] URLs instead of repository URLs

NOTES
  All arguments following the first occurrence of "--" are forwarded (in the
  same order they were given) to each "svn" command generated. Since the same
  command may run with multiple repositories, placeholder variables may be used
  in the given command line, which are then substituted with attributes from the
  target repository each time the "svn" command is run.

      @ = repository URL (must be first character in word)
      ^ = repository base name
      & = preceding URL/path argument
      $ = last path component (basename) of "&"
      ! = parent path component (basename of dirname) of "&"

  For example, exporting a common tag from all repositories with "DAPA" in the
  name into respectively-named subdirectories of the current directory:

      % resvn DAPA -- export @/tags/foo ./^/tags/foo
```

# Usage

First, please read the command-line usage reference that is output with the help flag `-h` (also copied above).

### Update repository cache

`resvn` operates primarily with a plain-text file, or cache, that defines all known repositories. The format of this file is simply one repository name per line. Each line should be the repository base name *only* (not a full URL). For example, a repository at URL `http://rstok3-dev02:3690/svn/APS_Team` would be represented by a single line containing only `APS_Team`. The full URL is generated by `resvn` using a combination of these repository names, the server URL prefix given with flag `-s` (or the default URL from environment variable `$RESVN_URL`), and the presence of flag `-w`.

Instead of creating and maintaining this cache manually, `resvn` is capable of requesting a list of all repositories from the SVN server and updating the cache automatically. When called with flag `-u`, and optionally flag `-l` if SVN credentials are not cached locally, the SVN server REST API is queried and results are written to a cache file in your current directory, overwriting any that already exists. You can copy this repository cache to your home directory, and it will be used as the default cache when calling `resvn` without flag `-f`.

# Install

### Compile from source code

```sh
# Clone the repository
git clone https://github.com/ardnew/resvn
cd resvn
# Compile executable
go build -v .
# Install somewhere in your $PATH
sudo cp resvn /usr/local/bin
```

### Build and install using only Go toolchain

#### Current Go version 1.16 and later:

###### Current release package
```sh
go install -v github.com/ardnew/resvn@latest
```

###### Tip of development branch (`main`)
```sh
go install -v github.com/ardnew/resvn@main
```

#### Legacy Go version 1.15 and earlier:

```sh
GO111MODULE=off go get -v github.com/ardnew/resvn
```
